((t,e,i,a,l)=>{let o="photoswipe",n=i.path.baseUrl,s=i.photoswipe.path||`${n}libraries/${o}`,p=`${s}/dist/${o}.esm.min.js`,r=`${s}/dist/${o}-lightbox.esm.min.js`,d=`${o}--on`,m=`[data-${o}-gallery]`,h=`[data-${o}-trigger]`,c=e.blazy||{},w=`blazy-${o}`,b=`${m}:not(.${d})`,g=t.sanitizer,f=0;function y(a){let o=i.photoswipe.options||{},n=t.findAll(a,`a${h}`),s=t.find(l.body,"> .pswp");function r(){if(!t.isElm(s))return;let e=t.find(s,".is-playing");if(t.isElm(e)){let i=t.find(s,".is-playing .media__icon--close");t.isElm(i)&&t.trigger(i,"click")}let a=t.find(s,"video");t.isElm(a)&&a.pause()}function w(t,e){return t.split(`${e}="`).pop().split('"')[0]}o.clickToCloseNonZoomable=!1,o.gallery=m,o.children=h,o.thumbSelector=h;let b=t.find(a,"[data-srcset]");o.preloadFirstSlide=!t.isElm(b),o.pswpModule=()=>import(p);let y=new PhotoSwipeLightbox(o);y.on("beforeOpen",()=>{e.blazyPhotoSwipe.lightbox.pswp=a.pswp.pswp=y.pswp}),y.on("itemData",i=>{let{element:a}=i.itemData;a&&(i.itemData=function i(a){let l={},o=a.nextElementSibling,s=t.parse(t.attr(a,"data-b-media data-media")),p=t.find(a,".media"),r=t.attr(a,"href"),d=t.attr(a,"data-box-url",r,!0),m=t.find(a,"img"),h=t.isElm(p)?t.attr(p,"data-b-thumb data-thumb"):"",c=t.attr(m,"alt",e.t("Preview"),!0),b=function t(e){let i=0;for(;i<n.length;i++){let a=n[i];if(a===e)break}return i}(a),f=s.owidth||null,y=s.oheight||null,u=s.width||null,S=s.height||null,z=f&&f>u?f:u,x=y&&y>S?y:S,P=t.toInt(f&&z<327?320:z,640),$=t.toInt(y&&x<327?520:x,360),v="";if(l.element=a,l.width=P,l.height=$,l.index=b,l.mediaType=s.boxType,l.irrational=s.irrational,l.alt=e.checkPlain(c),o&&t.hasClass(o,"litebox__caption")&&(l.caption=o.innerHTML),h&&(l.msrc=h),"html"in s){v=s.html,s.encoded&&(v=atob(v)),v=g.sanitize(v);let E=v.indexOf("srcset")>0;E?(l.type="image",l.srcset=w(v,"srcset"),l.src=w(v,"src")):(l.type="html",l.html=e.theme("blazyPhotoSwipe",{html:v,data:l}))}else"iframe"===s.boxType?(l.html=e.theme("blazyMedia",{el:a}),l.type="html"):(l.src=d,l.type="image");return l}(a))}),y.on("uiRegister",()=>{let i=e.blazyPhotoSwipe.ui||{};i.customCaption={name:"custom-caption",order:9,isButton:!1,appendTo:"root",html:"",onInit(e){y.pswp.on("change",()=>{let{data:i}=y.pswp.currSlide,a="caption"in i;e.innerHTML=a?g.sanitize(i.caption):"",t[a?"addClass":"removeClass"](e,"is-not-empty")})}},t.each(i,t=>{y.pswp.ui.registerElement(t)})}),y.on("slideDeactivate",()=>{r()}),y.on("afterSetContent",()=>{let i=c.init;s=y.pswp.template,e.attachBehaviors(s);let a=t.findAll(s,".b-lazy:not(.b-loaded)");a.length&&i&&i.load(a)}),y.on("slideActivate",i=>{let{slide:a}=i,{data:l}=a;clearTimeout(f),f=setTimeout(()=>{let i=t.find(a.container,".media");if(t.isElm(i)&&e.attachBehaviors(i),r(),l){let o=l.html,n=t.isElm(i)&&"video"===l.mediaType,p="iframe"===l.mediaType;if(t[o||n||p?"addClass":"removeClass"](s,"pswp--is-html"),p){let d=t.find(a.container,".media__icon--play");t.isElm(d)&&d.click()}}},1e3)}),y.on("pointerDown",()=>{t.addClass(s,"pswp--dragging")}),y.on("pointerUp",()=>{s.className.match("pswp--dragging")&&(s.className=s.className.replace(/(\S+)pswp--dragging/,""))}),y.on("close",()=>{r()}),e.blazyPhotoSwipe.beforeInit=y,y.init(),e.blazyPhotoSwipe.lightbox=y,a.pswp=y,e.blazyPhotoSwipe.afterInit=y,t.addClass(a,d)}e.blazyPhotoSwipe=t.extend(e.blazyPhotoSwipe||{},{init:import(r),pswp:import(p)}),e.theme.blazyPhotoSwipe=t=>{let{data:e}=t,i=e.irrational?" media-wrapper--noratio":"";return`<div class="pswp__item--html media-wrapper media-wrapper--box${i}" style="width: ${e.width}px">${t.html}</div>`},e.behaviors.blazyPhotoSwipe={attach(i){let l=t.findAll(i,b);l.length&&e.blazyPhotoSwipe.init.then(({default:e})=>{a.PhotoSwipeLightbox=a.PhotoSwipeLightbox||e,t.once(y,w,l,i)})}}})(dBlazy,Drupal,drupalSettings,this,this.document);
